<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot</title>
</head>
<body>
    <div class="js-container"></div>

    <script src="https://unpkg.com/supersimpledev@8.6.4/react.js"></script> <!-- to load react from the out website-->
    <script src="https://unpkg.com/supersimpledev@8.6.4/react-dom.js"></script> <!-- to load reactDom from the out website-->
    <script src="https://unpkg.com/supersimpledev@8.6.4/chatbot.js"></script>
    <script src="https://unpkg.com/supersimpledev@8.6.4/babel.js"></script><!-- to load react babel compiler from the out website-->
    <script src="https://unpkg.com/supersimpledev@8.6.4/dayjs.js"></script><!-- to load react can use with days and time-->
    <script type="text/babel">
        const container=document.querySelector('.js-container'); //To select the Div Elemenet from the html page
        function ChatInput({chatMessages,setChatMessages}) // This is an component example in React without props
        {
            const [inputText,setInputText]=React.useState('');
            function saveInputText(event)
            {
                setInputText(event.target.value);
            }
            function sendMessage()
            {
                const newChatMessages=[
                    ...chatMessages,
                    {
                        message:inputText,
                        sender:"user",
                        id:crypto.randomUUID()
                    }
                ];
                setChatMessages(newChatMessages);
                const response=Chatbot.getResponse(inputText);
                setChatMessages([
                    ...newChatMessages,
                    {
                        message:response,
                        sender:'robot',
                        id:crypto.randomUUID()
                    }
                ]);
                setInputText('');
            }
            function handleKeyDown(event)
            {
                if(event.key==='Enter')
                {
                    sendMessage();
                }else if(event.key==="Escape")
                {
                    setInputText('');
                }
            }
            return (
                <>
                    <input placeholder="Send a message to Chatbot" size="30"
                    onChange={saveInputText}
                    onKeyDown={handleKeyDown}
                    value={inputText}
                    ></input>
                    <button onClick={sendMessage}>Send</button>    
                </>
            );

        }
        /*
            ->Components means nothing but peice of our website. 
            ->This is an similar to a function in Java Script.
            ->We can re-use the components Many times this makes create's website easier.
        */
        function ChatMessage(props) // This is an simple example 'Component with props'. Props Make the Component More reuseable.  
        {
            const {message}=props; // same as 'cosnt message = props.message'
            const {sender}=props;  // This Feature is called Destructuring
            /*if(sender==="user")
            {
                return(
                    <div>
                        {message}
                        <img src="user.png" width="50"/>
                    </div>
                );
            }
            else{
                return(
                    <div>
                        <img src="robot.png" width="50"/>
                        {message}    
                    </div>
                );
            }
            */
           return( // This return Statement is an short-cut for above if-else statement 
                <div> {/* In JSX We can't able put directly if else statement. Instead of that we can use && operator.*/}
                    {sender === 'robot' && <img src="robot.png" width="50"/>}
                    {message} 
                    {sender === 'user' && <img src="user.png" width="50"/>}    
                </div>
           );
            
        }
        function ChatMessages({chatMessages})
        {
            return(
                <>
                    {chatMessages.map((chatMessage)=>
                        {
                            return(
                                <ChatMessage 
                                    message={chatMessage.message} 
                                    sender={chatMessage.sender}
                                    key={chatMessage.id}
                                />
                            );
                        })
                    }
                </>
            );
        }
        function App()
        {
            const [chatMessages,setChatMessages]=React.useState([{id:crypto.randomUUID()}]);
        // const chatMessages=array[0];
        // const setChatMessages=array[1];
            return(
                <>
                <ChatInput 
                    chatMessages={chatMessages}
                    setChatMessages={setChatMessages}
                />
                <ChatMessages 
                    chatMessages={chatMessages}
                />
                </>
            );
        }
        ReactDOM.createRoot(container).render(<App />);
    </script>
</body>
</html>